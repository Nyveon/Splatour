<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>3DGSM Editor</title>
		<link rel="stylesheet" href="./css/style.css" />
		<link rel="stylesheet" href="./css/viewer.css" />
		<link rel="stylesheet" href="./css/editor.css" />
	</head>
	<body
		x-data="{
        world: null,
        previewing: false,
        async loadPreview() {
            const jsondata = await (await fetch('test_map.json')).json();
            const gsmap = GS3dMap.deserializeFromJSON(jsondata);
            this.world = new GS3dViewer(gsmap, true);
        }
    }"
	>
		<header x-data>
			<div role="toolbar" x-data>
                <template x-if="world" x-data>
                    <div
                        class="text"
                        id="map-name"
                        x-data="{
                            editing: false,
                        }"
                        @keyup.escape.window="editing = false"
                    >
                        <span
                            x-text="world.gsmap.name"
                            :contenteditable="editing"
                        ></span>
                        <button class="edit" @click="editing = !editing">
                            <i x-feather="edit-3" x-show="!editing"></i>
                            <i x-feather="check" x-show="editing"></i>
                        </button>
                    </div>
                </template>
				<div></div>
				<button class="action"><i x-feather="upload"></i>Import</button>
				<button class="action"><i x-feather="download"></i>Export</button>
			</div>

			<div>Placeholder</div>
		</header>

        <main x-data>
            <aside>
                <ul>
                    <template x-for="scene in world.gsmap.scenes">
                        <li class="splat-file">
                            <span x-text="scene.name"></span>
                            <ul>
                                <li x-text="scene.filePath"></li>
                            </ul>
                        </li>
                    </template>
                </ul>
            </aside>

            <section id="preview">
                <button
                    x-show="!previewing"
                    class="big"
                    @click="
                    previewing = true;
                    await $nextTick();
                    loadPreview()
                    "
                >
                    <i x-feather="eye"></i>Load Preview
                </button>

                <div id="viewer" x-show="previewing"></div>
            </section>
        </main>


		<script type="module" src="./js/main.ts"></script>
	</body>
</html>
