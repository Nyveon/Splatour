<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>3DGSM Editor</title>
		<link rel="stylesheet" href="./css/style.css" />
        <link rel="stylesheet" href="./css/viewer.css" />
		<link rel="stylesheet" href="./css/editor.css" />
	</head>
	<body
		x-data="{
        mapdata: {
            'metadata': {
                'name': 'Loading...',
            }
        },
        previewing: false,
        loadPreview() {
            this.previewing = true;
            const world = gs3dviewer(this.mapdata, true);
        }
    }"
		x-init="mapdata = await (await fetch('test_map.json')).json();"
	>
		<header>
			<div role="toolbar">
				<div
					class="text"
					id="map-name"
					x-data="{ editing: false }"
					@keyup.escape.window="editing = false"
				>
					<span x-text="mapdata.metadata.name" :contenteditable="editing"></span>
					<button class="edit" @click="editing = !editing">
						<i data-feather="edit-3" x-show="!editing"></i>
						<i data-feather="check" x-show="editing"></i>
					</button>
				</div>
                <div></div>
				<button class="action"><i data-feather="upload"></i>Import</button>
				<button class="action"><i data-feather="download"></i>Export</button>
			</div>

			<div>Placeholder</div>
		</header>

		<main x-data>
			<aside>
				<ul>
					<template x-for="scene in mapdata.scenes">
						<li x-text="scene.filePath" class="splat-file"></li>
					</template>
				</ul>
			</aside>

            <section id="preview">
                <button x-show="!previewing" class="big" @click="
                    previewing = true;
                    await $nextTick();
                    loadPreview()
                    "><i data-feather="eye"></i>Load Preview</button>
    
                <div id="viewer" x-show="previewing"></div>
            </section>
		</main>

		<script type="module" src="./js/main.ts"></script>
	</body>
</html>
